<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <meta content="text/html; charset=UTF-8" http-equiv="Content-Type" />

  <title>Class: ActiveModel::Observer</title>

  <link rel="stylesheet" href="../rdoc.css" type="text/css" media="screen" />

  <script src="../js/jquery.js" type="text/javascript" charset="utf-8"></script>
  <script src="../js/thickbox-compressed.js" type="text/javascript" charset="utf-8"></script>
  <script src="../js/quicksearch.js" type="text/javascript" charset="utf-8"></script>
  <script src="../js/darkfish.js" type="text/javascript" charset="utf-8"></script>

</head>
<body id="top" class="class">

  <div id="metadata">
    <div id="home-metadata">
      <div id="home-section" class="section">
        <h3 class="section-header">
          <a href="../index.html">Home</a>
          <a href="../index.html#classes">Classes</a>
          <a href="../index.html#methods">Methods</a>
        </h3>
      </div>
    </div>

    <div id="file-metadata">
      <div id="file-list-section" class="section">
        <h3 class="section-header">In Files</h3>
        <div class="section-body">
          <ul>
          
            <li><a href="../lib/active_model/observing_rb.html?TB_iframe=true&amp;height=550&amp;width=785"
              class="thickbox" title="lib/active_model/observing.rb">lib/active_model/observing.rb</a></li>
          
          </ul>
        </div>
      </div>

      
    </div>

    <div id="class-metadata">
      
      <!-- Parent Class -->
      <div id="parent-class-section" class="section">
        <h3 class="section-header">Parent</h3>
        
        <p class="link">Object</p>
        
      </div>
      

      

      

      
      <!-- Method Quickref -->
      <div id="method-list-section" class="section">
        <h3 class="section-header">Methods</h3>
        <ul class="link-list">
          
          <li><a href="#method-c-new">::new</a></li>
          
          <li><a href="#method-c-observe">::observe</a></li>
          
          <li><a href="#method-c-observed_class">::observed_class</a></li>
          
          <li><a href="#method-c-observed_classes">::observed_classes</a></li>
          
          <li><a href="#method-i-disabled_for-3F">#disabled_for?</a></li>
          
        </ul>
      </div>
      

      
      <!-- Included Modules -->
      <div id="includes-section" class="section">
        <h3 class="section-header">Included Modules</h3>
        <ul class="link-list">
        
        
          <li><span class="include">Singleton</span></li>
        
        
        </ul>
      </div>
      
    </div>

    <div id="project-metadata">
      
      

      <div id="classindex-section" class="section project-section">
        <h3 class="section-header">Class/Module Index
          <span class="search-toggle"><img src="../images/find.png"
            height="16" width="16" alt="[+]"
            title="show/hide quicksearch" /></span></h3>
        <form action="#" method="get" accept-charset="utf-8" class="initially-hidden">
        <fieldset>
          <legend>Quicksearch</legend>
          <input type="text" name="quicksearch" value=""
            class="quicksearch-field" />
        </fieldset>
        </form>

        <ul class="link-list">
        
          <li><a href="../ActiveModel.html">ActiveModel</a></li>
        
          <li><a href="../ActiveModel/AttributeMethods.html">ActiveModel::AttributeMethods</a></li>
        
          <li><a href="../ActiveModel/AttributeMethods/ClassMethods.html">ActiveModel::AttributeMethods::ClassMethods</a></li>
        
          <li><a href="../ActiveModel/AttributeMethods/ClassMethods/AttributeMethodMatcher.html">ActiveModel::AttributeMethods::ClassMethods::AttributeMethodMatcher</a></li>
        
          <li><a href="../ActiveModel/BlockValidator.html">ActiveModel::BlockValidator</a></li>
        
          <li><a href="../ActiveModel/Callbacks.html">ActiveModel::Callbacks</a></li>
        
          <li><a href="../ActiveModel/Conversion.html">ActiveModel::Conversion</a></li>
        
          <li><a href="../ActiveModel/Dirty.html">ActiveModel::Dirty</a></li>
        
          <li><a href="../ActiveModel/EachValidator.html">ActiveModel::EachValidator</a></li>
        
          <li><a href="../ActiveModel/Errors.html">ActiveModel::Errors</a></li>
        
          <li><a href="../ActiveModel/Lint.html">ActiveModel::Lint</a></li>
        
          <li><a href="../ActiveModel/Lint/Tests.html">ActiveModel::Lint::Tests</a></li>
        
          <li><a href="../ActiveModel/MassAssignmentSecurity.html">ActiveModel::MassAssignmentSecurity</a></li>
        
          <li><a href="../ActiveModel/MassAssignmentSecurity/BlackList.html">ActiveModel::MassAssignmentSecurity::BlackList</a></li>
        
          <li><a href="../ActiveModel/MassAssignmentSecurity/ClassMethods.html">ActiveModel::MassAssignmentSecurity::ClassMethods</a></li>
        
          <li><a href="../ActiveModel/MassAssignmentSecurity/Error.html">ActiveModel::MassAssignmentSecurity::Error</a></li>
        
          <li><a href="../ActiveModel/MassAssignmentSecurity/LoggerSanitizer.html">ActiveModel::MassAssignmentSecurity::LoggerSanitizer</a></li>
        
          <li><a href="../ActiveModel/MassAssignmentSecurity/PermissionSet.html">ActiveModel::MassAssignmentSecurity::PermissionSet</a></li>
        
          <li><a href="../ActiveModel/MassAssignmentSecurity/Sanitizer.html">ActiveModel::MassAssignmentSecurity::Sanitizer</a></li>
        
          <li><a href="../ActiveModel/MassAssignmentSecurity/StrictSanitizer.html">ActiveModel::MassAssignmentSecurity::StrictSanitizer</a></li>
        
          <li><a href="../ActiveModel/MassAssignmentSecurity/WhiteList.html">ActiveModel::MassAssignmentSecurity::WhiteList</a></li>
        
          <li><a href="../ActiveModel/MissingAttributeError.html">ActiveModel::MissingAttributeError</a></li>
        
          <li><a href="../ActiveModel/Name.html">ActiveModel::Name</a></li>
        
          <li><a href="../ActiveModel/Naming.html">ActiveModel::Naming</a></li>
        
          <li><a href="../ActiveModel/Observer.html">ActiveModel::Observer</a></li>
        
          <li><a href="../ActiveModel/ObserverArray.html">ActiveModel::ObserverArray</a></li>
        
          <li><a href="../ActiveModel/Observing.html">ActiveModel::Observing</a></li>
        
          <li><a href="../ActiveModel/Observing/ClassMethods.html">ActiveModel::Observing::ClassMethods</a></li>
        
          <li><a href="../ActiveModel/SecurePassword.html">ActiveModel::SecurePassword</a></li>
        
          <li><a href="../ActiveModel/SecurePassword/ClassMethods.html">ActiveModel::SecurePassword::ClassMethods</a></li>
        
          <li><a href="../ActiveModel/SecurePassword/InstanceMethodsOnActivation.html">ActiveModel::SecurePassword::InstanceMethodsOnActivation</a></li>
        
          <li><a href="../ActiveModel/Serialization.html">ActiveModel::Serialization</a></li>
        
          <li><a href="../ActiveModel/Serializers.html">ActiveModel::Serializers</a></li>
        
          <li><a href="../ActiveModel/Serializers/JSON.html">ActiveModel::Serializers::JSON</a></li>
        
          <li><a href="../ActiveModel/Serializers/Xml.html">ActiveModel::Serializers::Xml</a></li>
        
          <li><a href="../ActiveModel/StrictValidationFailed.html">ActiveModel::StrictValidationFailed</a></li>
        
          <li><a href="../ActiveModel/Translation.html">ActiveModel::Translation</a></li>
        
          <li><a href="../ActiveModel/Validations.html">ActiveModel::Validations</a></li>
        
          <li><a href="../ActiveModel/Validations/AcceptanceValidator.html">ActiveModel::Validations::AcceptanceValidator</a></li>
        
          <li><a href="../ActiveModel/Validations/Callbacks.html">ActiveModel::Validations::Callbacks</a></li>
        
          <li><a href="../ActiveModel/Validations/Callbacks/ClassMethods.html">ActiveModel::Validations::Callbacks::ClassMethods</a></li>
        
          <li><a href="../ActiveModel/Validations/ClassMethods.html">ActiveModel::Validations::ClassMethods</a></li>
        
          <li><a href="../ActiveModel/Validations/ConfirmationValidator.html">ActiveModel::Validations::ConfirmationValidator</a></li>
        
          <li><a href="../ActiveModel/Validations/ExclusionValidator.html">ActiveModel::Validations::ExclusionValidator</a></li>
        
          <li><a href="../ActiveModel/Validations/FormatValidator.html">ActiveModel::Validations::FormatValidator</a></li>
        
          <li><a href="../ActiveModel/Validations/HelperMethods.html">ActiveModel::Validations::HelperMethods</a></li>
        
          <li><a href="../ActiveModel/Validations/InclusionValidator.html">ActiveModel::Validations::InclusionValidator</a></li>
        
          <li><a href="../ActiveModel/Validations/LengthValidator.html">ActiveModel::Validations::LengthValidator</a></li>
        
          <li><a href="../ActiveModel/Validations/NumericalityValidator.html">ActiveModel::Validations::NumericalityValidator</a></li>
        
          <li><a href="../ActiveModel/Validations/PresenceValidator.html">ActiveModel::Validations::PresenceValidator</a></li>
        
          <li><a href="../ActiveModel/Validations/WithValidator.html">ActiveModel::Validations::WithValidator</a></li>
        
          <li><a href="../ActiveModel/Validator.html">ActiveModel::Validator</a></li>
        
        </ul>
        <div id="no-class-search-results" style="display: none;">No matching classes.</div>
      </div>

      
    </div>
  </div>

  <div id="documentation">
    <h1 class="class">ActiveModel::Observer</h1>

    <div id="description" class="description">
      
<h2>Active Model Observers</h2>

<p><a href="Observer.html">Observer</a> classes respond to life cycle
callbacks to implement trigger-like behavior outside the original class.
This is a great way to reduce the clutter that normally comes when the
model class is burdened with functionality that doesn't pertain to the core
responsibility of the class. Example:</p>

<pre>class CommentObserver &lt; ActiveModel::Observer
  def after_save(comment)
    Notifications.comment(&quot;admin@do.com&quot;, &quot;New comment was posted&quot;, comment).deliver
  end
end</pre>

<p>This <a href="Observer.html">Observer</a> sends an email when a
Comment#save is finished.</p>

<pre>class ContactObserver &lt; ActiveModel::Observer
  def after_create(contact)
    contact.logger.info('New contact added!')
  end

  def after_destroy(contact)
    contact.logger.warn(&quot;Contact with an id of #{contact.id} was destroyed!&quot;)
  end
end</pre>

<p>This <a href="Observer.html">Observer</a> uses logger to log when specific
callbacks are triggered.</p>

<h2><a href="Observing.html">Observing</a> a class that can't be inferred</h2>

<p>Observers will by default be mapped to the class with which they share a
name. So CommentObserver will be tied to observing Comment,
ProductManagerObserver to ProductManager, and so on. If you want to name
your observer differently than the class you’re interested in observing,
you can use the <tt>Observer.observe</tt> class method which takes either
the concrete class (Product) or a symbol for that class (:product):</p>

<pre>class AuditObserver &lt; ActiveModel::Observer
  observe :account

  def after_update(account)
    AuditTrail.new(account, &quot;UPDATED&quot;)
  end
end</pre>

<p>If the audit observer needs to watch more than one kind of object, this can
be specified with multiple arguments:</p>

<pre>class AuditObserver &lt; ActiveModel::Observer
  observe :account, :balance

  def after_update(record)
    AuditTrail.new(record, &quot;UPDATED&quot;)
  end
end</pre>

<p>The AuditObserver will now act on both updates to Account and Balance by
treating them both as records.</p>

<p>If you’re using an <a href="Observer.html">Observer</a> in a Rails
application with Active Record, be sure to read about the necessary
configuration in the documentation for ActiveRecord::Observer.</p>

    </div><!-- description -->

    
    
    
    <div id="5Buntitled-5D" class="documentation-section">
      

      

      

      

      <!-- Methods -->
      
      <div id="public-class-method-details" class="method-section section">
        <h3 class="section-header">Public Class Methods</h3>

      
        <div id="new-method" class="method-detail ">
          <a name="method-c-new"></a>

          
          <div class="method-heading">
            <span class="method-name">new</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Start observing the declared classes and their subclasses.</p>
            

            
            <div class="method-source-code" id="new-source">
<pre>
<span class="ruby-comment"># File lib/active_model/observing.rb, line 218</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">initialize</span>
  <span class="ruby-identifier">observed_classes</span>.<span class="ruby-identifier">each</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">klass</span><span class="ruby-operator">|</span> <span class="ruby-identifier">add_observer!</span>(<span class="ruby-identifier">klass</span>) }
<span class="ruby-keyword">end</span></pre>
            </div><!-- new-source -->
            
          </div>

          

          
        </div><!-- new-method -->

      
        <div id="observe-method" class="method-detail ">
          <a name="method-c-observe"></a>

          
          <div class="method-heading">
            <span class="method-name">observe</span><span
              class="method-args">(*models)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Attaches the observer to the supplied model classes.</p>
            

            
            <div class="method-source-code" id="observe-source">
<pre>
<span class="ruby-comment"># File lib/active_model/observing.rb, line 187</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">observe</span>(*<span class="ruby-identifier">models</span>)
  <span class="ruby-identifier">models</span>.<span class="ruby-identifier">flatten!</span>
  <span class="ruby-identifier">models</span>.<span class="ruby-identifier">collect!</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">model</span><span class="ruby-operator">|</span> <span class="ruby-identifier">model</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-value">:to_sym</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">model</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">camelize</span>.<span class="ruby-identifier">constantize</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">model</span> }
  <span class="ruby-identifier">redefine_method</span>(<span class="ruby-value">:observed_classes</span>) { <span class="ruby-identifier">models</span> }
<span class="ruby-keyword">end</span></pre>
            </div><!-- observe-source -->
            
          </div>

          

          
        </div><!-- observe-method -->

      
        <div id="observed_class-method" class="method-detail ">
          <a name="method-c-observed_class"></a>

          
          <div class="method-heading">
            <span class="method-name">observed_class</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>The class observed by default is inferred from the observer’s class name:</p>

<pre>assert_equal Person, PersonObserver.observed_class</pre>
            

            
            <div class="method-source-code" id="observed_class-source">
<pre>
<span class="ruby-comment"># File lib/active_model/observing.rb, line 208</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">observed_class</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">observed_class_name</span> = <span class="ruby-identifier">name</span>[<span class="ruby-regexp">/(.*)Observer/</span>, <span class="ruby-value">1</span>]
    <span class="ruby-identifier">observed_class_name</span>.<span class="ruby-identifier">constantize</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-keyword">nil</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- observed_class-source -->
            
          </div>

          

          
        </div><!-- observed_class-method -->

      
        <div id="observed_classes-method" class="method-detail ">
          <a name="method-c-observed_classes"></a>

          
          <div class="method-heading">
            <span class="method-name">observed_classes</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Returns an array of Classes to observe.</p>

<p>You can override this instead of using the <tt>observe</tt> helper.</p>

<pre>class AuditObserver &lt; ActiveModel::Observer
  def self.observed_classes
    [Account, Balance]
  end
end</pre>
            

            
            <div class="method-source-code" id="observed_classes-source">
<pre>
<span class="ruby-comment"># File lib/active_model/observing.rb, line 202</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">observed_classes</span>
  <span class="ruby-constant">Array</span>.<span class="ruby-identifier">wrap</span>(<span class="ruby-identifier">observed_class</span>)
<span class="ruby-keyword">end</span></pre>
            </div><!-- observed_classes-source -->
            
          </div>

          

          
        </div><!-- observed_classes-method -->

      
      </div><!-- public-class-method-details -->
    
      <div id="protected-instance-method-details" class="method-section section">
        <h3 class="section-header">Protected Instance Methods</h3>

      
        <div id="disabled_for-3F-method" class="method-detail ">
          <a name="method-i-disabled_for-3F"></a>

          
          <div class="method-heading">
            <span class="method-name">disabled_for?</span><span
              class="method-args">(object)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            
            

            
            <div class="method-source-code" id="disabled_for-3F-source">
<pre>
<span class="ruby-comment"># File lib/active_model/observing.rb, line 246</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">disabled_for?</span>(<span class="ruby-identifier">object</span>)
  <span class="ruby-identifier">klass</span> = <span class="ruby-identifier">object</span>.<span class="ruby-identifier">class</span>
  <span class="ruby-keyword">return</span> <span class="ruby-keyword">false</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">klass</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-value">:observers</span>)
  <span class="ruby-identifier">klass</span>.<span class="ruby-identifier">observers</span>.<span class="ruby-identifier">disabled_for?</span>(<span class="ruby-keyword">self</span>)
<span class="ruby-keyword">end</span></pre>
            </div><!-- disabled_for-3F-source -->
            
          </div>

          

          
        </div><!-- disabled_for-3F-method -->

      
      </div><!-- protected-instance-method-details -->
    
    </div><!-- 5Buntitled-5D -->
  

  </div><!-- documentation -->

  <div id="validator-badges">
    <p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
    <p><small>Generated with the <a href="http://deveiate.org/projects/Darkfish-Rdoc/">Darkfish
      Rdoc Generator</a> 2</small>.</p>
  </div>

</body>
</html>

