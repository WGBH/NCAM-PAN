<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <meta content="text/html; charset=UTF-8" http-equiv="Content-Type" />

  <title>Class: Sprockets::Base</title>

  <link rel="stylesheet" href="../rdoc.css" type="text/css" media="screen" />

  <script src="../js/jquery.js" type="text/javascript" charset="utf-8"></script>
  <script src="../js/thickbox-compressed.js" type="text/javascript" charset="utf-8"></script>
  <script src="../js/quicksearch.js" type="text/javascript" charset="utf-8"></script>
  <script src="../js/darkfish.js" type="text/javascript" charset="utf-8"></script>

</head>
<body id="top" class="class">

  <div id="metadata">
    <div id="home-metadata">
      <div id="home-section" class="section">
        <h3 class="section-header">
          <a href="../index.html">Home</a>
          <a href="../index.html#classes">Classes</a>
          <a href="../index.html#methods">Methods</a>
        </h3>
      </div>
    </div>

    <div id="file-metadata">
      <div id="file-list-section" class="section">
        <h3 class="section-header">In Files</h3>
        <div class="section-body">
          <ul>
          
            <li><a href="../lib/sprockets/base_rb.html?TB_iframe=true&amp;height=550&amp;width=785"
              class="thickbox" title="lib/sprockets/base.rb">lib/sprockets/base.rb</a></li>
          
          </ul>
        </div>
      </div>

      
    </div>

    <div id="class-metadata">
      
      <!-- Parent Class -->
      <div id="parent-class-section" class="section">
        <h3 class="section-header">Parent</h3>
        
        <p class="link">Object</p>
        
      </div>
      

      

      

      
      <!-- Method Quickref -->
      <div id="method-list-section" class="section">
        <h3 class="section-header">Methods</h3>
        <ul class="link-list">
          
          <li><a href="#method-i-5B-5D">#[]</a></li>
          
          <li><a href="#method-i-attributes_for">#attributes_for</a></li>
          
          <li><a href="#method-i-build_asset">#build_asset</a></li>
          
          <li><a href="#method-i-cache-3D">#cache=</a></li>
          
          <li><a href="#method-i-cache_key_for">#cache_key_for</a></li>
          
          <li><a href="#method-i-circular_call_protection">#circular_call_protection</a></li>
          
          <li><a href="#method-i-content_type_of">#content_type_of</a></li>
          
          <li><a href="#method-i-digest">#digest</a></li>
          
          <li><a href="#method-i-digest_class-3D">#digest_class=</a></li>
          
          <li><a href="#method-i-each_entry">#each_entry</a></li>
          
          <li><a href="#method-i-each_file">#each_file</a></li>
          
          <li><a href="#method-i-each_logical_path">#each_logical_path</a></li>
          
          <li><a href="#method-i-entries">#entries</a></li>
          
          <li><a href="#method-i-expire_index-21">#expire_index!</a></li>
          
          <li><a href="#method-i-file_digest">#file_digest</a></li>
          
          <li><a href="#method-i-find_asset">#find_asset</a></li>
          
          <li><a href="#method-i-index">#index</a></li>
          
          <li><a href="#method-i-inspect">#inspect</a></li>
          
          <li><a href="#method-i-stat">#stat</a></li>
          
          <li><a href="#method-i-version-3D">#version=</a></li>
          
        </ul>
      </div>
      

      
      <!-- Included Modules -->
      <div id="includes-section" class="section">
        <h3 class="section-header">Included Modules</h3>
        <ul class="link-list">
        
        
          <li><a class="include" href="Caching.html">Sprockets::Caching</a></li>
        
        
        
          <li><a class="include" href="Processing.html">Sprockets::Processing</a></li>
        
        
        
          <li><a class="include" href="Server.html">Sprockets::Server</a></li>
        
        
        
          <li><a class="include" href="Trail.html">Sprockets::Trail</a></li>
        
        
        </ul>
      </div>
      
    </div>

    <div id="project-metadata">
      
      

      <div id="classindex-section" class="section project-section">
        <h3 class="section-header">Class/Module Index
          <span class="search-toggle"><img src="../images/find.png"
            height="16" width="16" alt="[+]"
            title="show/hide quicksearch" /></span></h3>
        <form action="#" method="get" accept-charset="utf-8" class="initially-hidden">
        <fieldset>
          <legend>Quicksearch</legend>
          <input type="text" name="quicksearch" value=""
            class="quicksearch-field" />
        </fieldset>
        </form>

        <ul class="link-list">
        
          <li><a href="../Sprockets.html">Sprockets</a></li>
        
          <li><a href="../Sprockets/ArgumentError.html">Sprockets::ArgumentError</a></li>
        
          <li><a href="../Sprockets/Asset.html">Sprockets::Asset</a></li>
        
          <li><a href="../Sprockets/AssetAttributes.html">Sprockets::AssetAttributes</a></li>
        
          <li><a href="../Sprockets/Base.html">Sprockets::Base</a></li>
        
          <li><a href="../Sprockets/BundledAsset.html">Sprockets::BundledAsset</a></li>
        
          <li><a href="../Sprockets/Cache.html">Sprockets::Cache</a></li>
        
          <li><a href="../Sprockets/Cache/FileStore.html">Sprockets::Cache::FileStore</a></li>
        
          <li><a href="../Sprockets/Caching.html">Sprockets::Caching</a></li>
        
          <li><a href="../Sprockets/CharsetNormalizer.html">Sprockets::CharsetNormalizer</a></li>
        
          <li><a href="../Sprockets/CircularDependencyError.html">Sprockets::CircularDependencyError</a></li>
        
          <li><a href="../Sprockets/ContentTypeMismatch.html">Sprockets::ContentTypeMismatch</a></li>
        
          <li><a href="../Sprockets/Context.html">Sprockets::Context</a></li>
        
          <li><a href="../Sprockets/DirectiveProcessor.html">Sprockets::DirectiveProcessor</a></li>
        
          <li><a href="../Sprockets/EcoTemplate.html">Sprockets::EcoTemplate</a></li>
        
          <li><a href="../Sprockets/EjsTemplate.html">Sprockets::EjsTemplate</a></li>
        
          <li><a href="../Sprockets/EncodingError.html">Sprockets::EncodingError</a></li>
        
          <li><a href="../Sprockets/EngineError.html">Sprockets::EngineError</a></li>
        
          <li><a href="../Sprockets/Engines.html">Sprockets::Engines</a></li>
        
          <li><a href="../Sprockets/Environment.html">Sprockets::Environment</a></li>
        
          <li><a href="../Sprockets/Error.html">Sprockets::Error</a></li>
        
          <li><a href="../Sprockets/FileNotFound.html">Sprockets::FileNotFound</a></li>
        
          <li><a href="../Sprockets/FileOutsidePaths.html">Sprockets::FileOutsidePaths</a></li>
        
          <li><a href="../Sprockets/Index.html">Sprockets::Index</a></li>
        
          <li><a href="../Sprockets/JstProcessor.html">Sprockets::JstProcessor</a></li>
        
          <li><a href="../Sprockets/Mime.html">Sprockets::Mime</a></li>
        
          <li><a href="../Sprockets/ProcessedAsset.html">Sprockets::ProcessedAsset</a></li>
        
          <li><a href="../Sprockets/ProcessedAsset/DependencyFile.html">Sprockets::ProcessedAsset::DependencyFile</a></li>
        
          <li><a href="../Sprockets/Processing.html">Sprockets::Processing</a></li>
        
          <li><a href="../Sprockets/Processor.html">Sprockets::Processor</a></li>
        
          <li><a href="../Sprockets/SafetyColons.html">Sprockets::SafetyColons</a></li>
        
          <li><a href="../Sprockets/Server.html">Sprockets::Server</a></li>
        
          <li><a href="../Sprockets/StaticAsset.html">Sprockets::StaticAsset</a></li>
        
          <li><a href="../Sprockets/Trail.html">Sprockets::Trail</a></li>
        
          <li><a href="../Sprockets/UnserializeError.html">Sprockets::UnserializeError</a></li>
        
          <li><a href="../Sprockets/Utils.html">Sprockets::Utils</a></li>
        
        </ul>
        <div id="no-class-search-results" style="display: none;">No matching classes.</div>
      </div>

      
    </div>
  </div>

  <div id="documentation">
    <h1 class="class">Sprockets::Base</h1>

    <div id="description" class="description">
      
<p>`Base` class for `Environment` and `Index`.</p>

    </div><!-- description -->

    
    
    
    <div id="5Buntitled-5D" class="documentation-section">
      

      

      

      
      <!-- Attributes -->
      <div id="attribute-method-details" class="method-section section">
        <h3 class="section-header">Attributes</h3>

        
        <div id="cache-attribute-method" class="method-detail">
          <a name="cache"></a>
          
          <div class="method-heading attribute-method-heading">
            <span class="method-name">cache</span><span
              class="attribute-access-type">[R]</span>
          </div>

          <div class="method-description">
          
          <p>Get persistent cache store</p>
          
          </div>
        </div>
        
        <div id="context_class-attribute-method" class="method-detail">
          <a name="context_class"></a>
          
          <div class="method-heading attribute-method-heading">
            <span class="method-name">context_class</span><span
              class="attribute-access-type">[R]</span>
          </div>

          <div class="method-description">
          
          <p>Get `Context` class.</p>

<p>This class maybe mutated and mixed in with custom helpers.</p>

<pre>environment.context_class.instance_eval do
  include MyHelpers
  def asset_url; end
end</pre>
          
          </div>
        </div>
        
        <div id="digest_class-attribute-method" class="method-detail">
          <a name="digest_class"></a>
          
          <div class="method-heading attribute-method-heading">
            <span class="method-name">digest_class</span><span
              class="attribute-access-type">[R]</span>
          </div>

          <div class="method-description">
          
          <p>Returns a `Digest` implementation class.</p>

<p>Defaults to `Digest::MD5`.</p>
          
          </div>
        </div>
        
        <div id="logger-attribute-method" class="method-detail">
          <a name="logger"></a>
          
          <a name="logger="></a>
          
          <div class="method-heading attribute-method-heading">
            <span class="method-name">logger</span><span
              class="attribute-access-type">[RW]</span>
          </div>

          <div class="method-description">
          
          <p>Get and set `Logger` instance.</p>
          
          </div>
        </div>
        
        <div id="version-attribute-method" class="method-detail">
          <a name="version"></a>
          
          <div class="method-heading attribute-method-heading">
            <span class="method-name">version</span><span
              class="attribute-access-type">[R]</span>
          </div>

          <div class="method-description">
          
          <p>The `Environment#version` is a custom value used for manually expiring all
asset caches.</p>

<p><a href="../Sprockets.html">Sprockets</a> is able to track most file and
directory changes and will take care of expiring the cache for you.
However, its impossible to know when any custom helpers change that you mix
into the `Context`.</p>

<p>It would be wise to increment this value anytime you make a configuration
change to the `Environment` object.</p>
          
          </div>
        </div>
        
      </div><!-- attribute-method-details -->
      

      <!-- Methods -->
      
      <div id="public-instance-method-details" class="method-section section">
        <h3 class="section-header">Public Instance Methods</h3>

      
        <div id="5B-5D-method" class="method-detail ">
          <a name="method-i-5B-5D"></a>

          
          <div class="method-heading">
            <span class="method-name">[]</span><span
              class="method-args">(*args)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Preferred `<a href="Base.html#method-i-find_asset">find_asset</a>`
shorthand.</p>

<pre>environment['application.js']</pre>
            

            
            <div class="method-source-code" id="5B-5D-source">
<pre>
<span class="ruby-comment"># File lib/sprockets/base.rb, line 170</span>
<span class="ruby-keyword">def</span> <span class="ruby-operator">[]</span>(*<span class="ruby-identifier">args</span>)
  <span class="ruby-identifier">find_asset</span>(*<span class="ruby-identifier">args</span>)
<span class="ruby-keyword">end</span></pre>
            </div><!-- 5B-5D-source -->
            
          </div>

          

          
        </div><!-- 5B-5D-method -->

      
        <div id="attributes_for-method" class="method-detail ">
          <a name="method-i-attributes_for"></a>

          
          <div class="method-heading">
            <span class="method-name">attributes_for</span><span
              class="method-args">(path)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Internal. Return a `AssetAttributes` for `path`.</p>
            

            
            <div class="method-source-code" id="attributes_for-source">
<pre>
<span class="ruby-comment"># File lib/sprockets/base.rb, line 138</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">attributes_for</span>(<span class="ruby-identifier">path</span>)
  <span class="ruby-constant">AssetAttributes</span>.<span class="ruby-identifier">new</span>(<span class="ruby-keyword">self</span>, <span class="ruby-identifier">path</span>)
<span class="ruby-keyword">end</span></pre>
            </div><!-- attributes_for-source -->
            
          </div>

          

          
        </div><!-- attributes_for-method -->

      
        <div id="cache-3D-method" class="method-detail ">
          <a name="method-i-cache-3D"></a>

          
          <div class="method-heading">
            <span class="method-name">cache=</span><span
              class="method-args">(cache)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Set persistent cache store</p>

<p>The cache store must implement a pair of getters and setters. Either
`get(key)`/`set(key, value)`, `[<a href="http://key">key]`/`</a>=value`,
`read(key)`/`write(key, value)`.</p>
            

            
            <div class="method-source-code" id="cache-3D-source">
<pre>
<span class="ruby-comment"># File lib/sprockets/base.rb, line 96</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">cache=</span>(<span class="ruby-identifier">cache</span>)
  <span class="ruby-identifier">expire_index!</span>
  <span class="ruby-ivar">@cache</span> = <span class="ruby-identifier">cache</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- cache-3D-source -->
            
          </div>

          

          
        </div><!-- cache-3D-method -->

      
        <div id="content_type_of-method" class="method-detail ">
          <a name="method-i-content_type_of"></a>

          
          <div class="method-heading">
            <span class="method-name">content_type_of</span><span
              class="method-args">(path)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Internal. Return content type of `path`.</p>
            

            
            <div class="method-source-code" id="content_type_of-source">
<pre>
<span class="ruby-comment"># File lib/sprockets/base.rb, line 143</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">content_type_of</span>(<span class="ruby-identifier">path</span>)
  <span class="ruby-identifier">attributes_for</span>(<span class="ruby-identifier">path</span>).<span class="ruby-identifier">content_type</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- content_type_of-source -->
            
          </div>

          

          
        </div><!-- content_type_of-method -->

      
        <div id="digest-method" class="method-detail ">
          <a name="method-i-digest"></a>

          
          <div class="method-heading">
            <span class="method-name">digest</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Returns a `Digest` instance for the `Environment`.</p>

<p>This value serves two purposes. If two `Environment`s have the same digest
value they can be treated as equal. This is more useful for comparing
environment states between processes rather than in the same. Two equal
`Environment`s can share the same cached assets.</p>

<p>The value also provides a seed digest for all `Asset` digests. Any change
in the environment digest will affect all of its assets.</p>
            

            
            <div class="method-source-code" id="digest-source">
<pre>
<span class="ruby-comment"># File lib/sprockets/base.rb, line 64</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">digest</span>
  <span class="ruby-comment"># Compute the initial digest using the implementation class. The</span>
  <span class="ruby-comment"># Sprockets release version and custom environment version are</span>
  <span class="ruby-comment"># mixed in. So any new releases will affect all your assets.</span>
  <span class="ruby-ivar">@digest</span> <span class="ruby-operator">||=</span> <span class="ruby-identifier">digest_class</span>.<span class="ruby-identifier">new</span>.<span class="ruby-identifier">update</span>(<span class="ruby-constant">VERSION</span>).<span class="ruby-identifier">update</span>(<span class="ruby-identifier">version</span>.<span class="ruby-identifier">to_s</span>)

  <span class="ruby-comment"># Returned a dupped copy so the caller can safely mutate it with `.update`</span>
  <span class="ruby-ivar">@digest</span>.<span class="ruby-identifier">dup</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- digest-source -->
            
          </div>

          

          
        </div><!-- digest-method -->

      
        <div id="digest_class-3D-method" class="method-detail ">
          <a name="method-i-digest_class-3D"></a>

          
          <div class="method-heading">
            <span class="method-name">digest_class=</span><span
              class="method-args">(klass)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Assign a `Digest` implementation class. This maybe any Ruby `Digest::`
implementation such as `Digest::MD5` or `Digest::SHA1`.</p>

<pre>environment.digest_class = Digest::SHA1</pre>
            

            
            <div class="method-source-code" id="digest_class-3D-source">
<pre>
<span class="ruby-comment"># File lib/sprockets/base.rb, line 27</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">digest_class=</span>(<span class="ruby-identifier">klass</span>)
  <span class="ruby-identifier">expire_index!</span>
  <span class="ruby-ivar">@digest_class</span> = <span class="ruby-identifier">klass</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- digest_class-3D-source -->
            
          </div>

          

          
        </div><!-- digest_class-3D-method -->

      
        <div id="each_entry-method" class="method-detail ">
          <a name="method-i-each_entry"></a>

          
          <div class="method-heading">
            <span class="method-name">each_entry</span><span
              class="method-args">(root, &block)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            
            

            
            <div class="method-source-code" id="each_entry-source">
<pre>
<span class="ruby-comment"># File lib/sprockets/base.rb, line 174</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">each_entry</span>(<span class="ruby-identifier">root</span>, &amp;<span class="ruby-identifier">block</span>)
  <span class="ruby-keyword">return</span> <span class="ruby-identifier">to_enum</span>(<span class="ruby-identifier">__method__</span>, <span class="ruby-identifier">root</span>) <span class="ruby-keyword">unless</span> <span class="ruby-identifier">block_given?</span>
  <span class="ruby-identifier">root</span> = <span class="ruby-constant">Pathname</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">root</span>) <span class="ruby-keyword">unless</span> <span class="ruby-identifier">root</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Pathname</span>)

  <span class="ruby-identifier">paths</span> = []
  <span class="ruby-identifier">entries</span>(<span class="ruby-identifier">root</span>).<span class="ruby-identifier">sort</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">filename</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">path</span> = <span class="ruby-identifier">root</span>.<span class="ruby-identifier">join</span>(<span class="ruby-identifier">filename</span>)
    <span class="ruby-identifier">paths</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">path</span>

    <span class="ruby-keyword">if</span> <span class="ruby-identifier">stat</span>(<span class="ruby-identifier">path</span>).<span class="ruby-identifier">directory?</span>
      <span class="ruby-identifier">each_entry</span>(<span class="ruby-identifier">path</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">subpath</span><span class="ruby-operator">|</span>
        <span class="ruby-identifier">paths</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">subpath</span>
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">paths</span>.<span class="ruby-identifier">sort_by</span>(&amp;<span class="ruby-value">:to_s</span>).<span class="ruby-identifier">each</span>(&amp;<span class="ruby-identifier">block</span>)

  <span class="ruby-keyword">nil</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- each_entry-source -->
            
          </div>

          

          
        </div><!-- each_entry-method -->

      
        <div id="each_file-method" class="method-detail ">
          <a name="method-i-each_file"></a>

          
          <div class="method-heading">
            <span class="method-name">each_file</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            
            

            
            <div class="method-source-code" id="each_file-source">
<pre>
<span class="ruby-comment"># File lib/sprockets/base.rb, line 195</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">each_file</span>
  <span class="ruby-keyword">return</span> <span class="ruby-identifier">to_enum</span>(<span class="ruby-identifier">__method__</span>) <span class="ruby-keyword">unless</span> <span class="ruby-identifier">block_given?</span>
  <span class="ruby-identifier">paths</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">root</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">each_entry</span>(<span class="ruby-identifier">root</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">path</span><span class="ruby-operator">|</span>
      <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">stat</span>(<span class="ruby-identifier">path</span>).<span class="ruby-identifier">directory?</span>
        <span class="ruby-keyword">yield</span> <span class="ruby-identifier">path</span>
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">nil</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- each_file-source -->
            
          </div>

          

          
        </div><!-- each_file-method -->

      
        <div id="each_logical_path-method" class="method-detail ">
          <a name="method-i-each_logical_path"></a>

          
          <div class="method-heading">
            <span class="method-name">each_logical_path</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            
            

            
            <div class="method-source-code" id="each_logical_path-source">
<pre>
<span class="ruby-comment"># File lib/sprockets/base.rb, line 207</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">each_logical_path</span>
  <span class="ruby-keyword">return</span> <span class="ruby-identifier">to_enum</span>(<span class="ruby-identifier">__method__</span>) <span class="ruby-keyword">unless</span> <span class="ruby-identifier">block_given?</span>
  <span class="ruby-identifier">files</span> = {}
  <span class="ruby-identifier">each_file</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">filename</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">logical_path</span> = <span class="ruby-identifier">attributes_for</span>(<span class="ruby-identifier">filename</span>).<span class="ruby-identifier">logical_path</span>
    <span class="ruby-keyword">yield</span> <span class="ruby-identifier">logical_path</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">files</span>[<span class="ruby-identifier">logical_path</span>]
    <span class="ruby-identifier">files</span>[<span class="ruby-identifier">logical_path</span>] = <span class="ruby-keyword">true</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">nil</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- each_logical_path-source -->
            
          </div>

          

          
        </div><!-- each_logical_path-method -->

      
        <div id="entries-method" class="method-detail ">
          <a name="method-i-entries"></a>

          
          <div class="method-heading">
            <span class="method-name">entries</span><span
              class="method-args">(pathname)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Works like `Dir.entries`.</p>

<p>Subclasses may cache this method.</p>
            

            
            <div class="method-source-code" id="entries-source">
<pre>
<span class="ruby-comment"># File lib/sprockets/base.rb, line 109</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">entries</span>(<span class="ruby-identifier">pathname</span>)
  <span class="ruby-identifier">trail</span>.<span class="ruby-identifier">entries</span>(<span class="ruby-identifier">pathname</span>)
<span class="ruby-keyword">end</span></pre>
            </div><!-- entries-source -->
            
          </div>

          

          
        </div><!-- entries-method -->

      
        <div id="file_digest-method" class="method-detail ">
          <a name="method-i-file_digest"></a>

          
          <div class="method-heading">
            <span class="method-name">file_digest</span><span
              class="method-args">(path)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Read and compute digest of filename.</p>

<p>Subclasses may cache this method.</p>
            

            
            <div class="method-source-code" id="file_digest-source">
<pre>
<span class="ruby-comment"># File lib/sprockets/base.rb, line 123</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">file_digest</span>(<span class="ruby-identifier">path</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">stat</span> = <span class="ruby-keyword">self</span>.<span class="ruby-identifier">stat</span>(<span class="ruby-identifier">path</span>)
    <span class="ruby-comment"># If its a file, digest the contents</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">stat</span>.<span class="ruby-identifier">file?</span>
      <span class="ruby-identifier">digest</span>.<span class="ruby-identifier">file</span>(<span class="ruby-identifier">path</span>.<span class="ruby-identifier">to_s</span>)

    <span class="ruby-comment"># If its a directive, digest the list of filenames</span>
    <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">stat</span>.<span class="ruby-identifier">directory?</span>
      <span class="ruby-identifier">contents</span> = <span class="ruby-keyword">self</span>.<span class="ruby-identifier">entries</span>(<span class="ruby-identifier">path</span>).<span class="ruby-identifier">join</span>(<span class="ruby-string">','</span>)
      <span class="ruby-identifier">digest</span>.<span class="ruby-identifier">update</span>(<span class="ruby-identifier">contents</span>)
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- file_digest-source -->
            
          </div>

          

          
        </div><!-- file_digest-method -->

      
        <div id="find_asset-method" class="method-detail ">
          <a name="method-i-find_asset"></a>

          
          <div class="method-heading">
            <span class="method-name">find_asset</span><span
              class="method-args">(path, options = {})</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Find asset by logical path or expanded path.</p>
            

            
            <div class="method-source-code" id="find_asset-source">
<pre>
<span class="ruby-comment"># File lib/sprockets/base.rb, line 148</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">find_asset</span>(<span class="ruby-identifier">path</span>, <span class="ruby-identifier">options</span> = {})
  <span class="ruby-identifier">logical_path</span> = <span class="ruby-identifier">path</span>
  <span class="ruby-identifier">pathname</span>     = <span class="ruby-constant">Pathname</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">path</span>)

  <span class="ruby-keyword">if</span> <span class="ruby-identifier">pathname</span>.<span class="ruby-identifier">absolute?</span>
    <span class="ruby-keyword">return</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">stat</span>(<span class="ruby-identifier">pathname</span>)
    <span class="ruby-identifier">logical_path</span> = <span class="ruby-identifier">attributes_for</span>(<span class="ruby-identifier">pathname</span>).<span class="ruby-identifier">logical_path</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-keyword">begin</span>
      <span class="ruby-identifier">pathname</span> = <span class="ruby-identifier">resolve</span>(<span class="ruby-identifier">logical_path</span>)
    <span class="ruby-keyword">rescue</span> <span class="ruby-constant">FileNotFound</span>
      <span class="ruby-keyword">return</span> <span class="ruby-keyword">nil</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">build_asset</span>(<span class="ruby-identifier">logical_path</span>, <span class="ruby-identifier">pathname</span>, <span class="ruby-identifier">options</span>)
<span class="ruby-keyword">end</span></pre>
            </div><!-- find_asset-source -->
            
          </div>

          

          
        </div><!-- find_asset-method -->

      
        <div id="index-method" class="method-detail ">
          <a name="method-i-index"></a>

          
          <div class="method-heading">
            <span class="method-name">index</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Return an `Index`. Must be implemented by the subclass.</p>
            

            
            <div class="method-source-code" id="index-source">
<pre>
<span class="ruby-comment"># File lib/sprockets/base.rb, line 102</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">index</span>
  <span class="ruby-identifier">raise</span> <span class="ruby-constant">NotImplementedError</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- index-source -->
            
          </div>

          

          
        </div><!-- index-method -->

      
        <div id="inspect-method" class="method-detail ">
          <a name="method-i-inspect"></a>

          
          <div class="method-heading">
            <span class="method-name">inspect</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Pretty inspect</p>
            

            
            <div class="method-source-code" id="inspect-source">
<pre>
<span class="ruby-comment"># File lib/sprockets/base.rb, line 219</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">inspect</span>
  <span class="ruby-node">&quot;#&lt;#{self.class}:0x#{object_id.to_s(16)} &quot;</span> <span class="ruby-operator">+</span>
    <span class="ruby-node">&quot;root=#{root.to_s.inspect}, &quot;</span> <span class="ruby-operator">+</span>
    <span class="ruby-node">&quot;paths=#{paths.inspect}, &quot;</span> <span class="ruby-operator">+</span>
    <span class="ruby-node">&quot;digest=#{digest.to_s.inspect}&quot;</span> <span class="ruby-operator">+</span>
    <span class="ruby-string">&quot;&gt;&quot;</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- inspect-source -->
            
          </div>

          

          
        </div><!-- inspect-method -->

      
        <div id="stat-method" class="method-detail ">
          <a name="method-i-stat"></a>

          
          <div class="method-heading">
            <span class="method-name">stat</span><span
              class="method-args">(path)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Works like `File.stat`.</p>

<p>Subclasses may cache this method.</p>
            

            
            <div class="method-source-code" id="stat-source">
<pre>
<span class="ruby-comment"># File lib/sprockets/base.rb, line 116</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">stat</span>(<span class="ruby-identifier">path</span>)
  <span class="ruby-identifier">trail</span>.<span class="ruby-identifier">stat</span>(<span class="ruby-identifier">path</span>)
<span class="ruby-keyword">end</span></pre>
            </div><!-- stat-source -->
            
          </div>

          

          
        </div><!-- stat-method -->

      
        <div id="version-3D-method" class="method-detail ">
          <a name="method-i-version-3D"></a>

          
          <div class="method-heading">
            <span class="method-name">version=</span><span
              class="method-args">(version)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Assign an environment version.</p>

<pre>environment.version = '2.0'</pre>
            

            
            <div class="method-source-code" id="version-3D-source">
<pre>
<span class="ruby-comment"># File lib/sprockets/base.rb, line 48</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">version=</span>(<span class="ruby-identifier">version</span>)
  <span class="ruby-identifier">expire_index!</span>
  <span class="ruby-ivar">@version</span> = <span class="ruby-identifier">version</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- version-3D-source -->
            
          </div>

          

          
        </div><!-- version-3D-method -->

      
      </div><!-- public-instance-method-details -->
    
      <div id="protected-instance-method-details" class="method-section section">
        <h3 class="section-header">Protected Instance Methods</h3>

      
        <div id="build_asset-method" class="method-detail ">
          <a name="method-i-build_asset"></a>

          
          <div class="method-heading">
            <span class="method-name">build_asset</span><span
              class="method-args">(logical_path, pathname, options)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            
            

            
            <div class="method-source-code" id="build_asset-source">
<pre>
<span class="ruby-comment"># File lib/sprockets/base.rb, line 233</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">build_asset</span>(<span class="ruby-identifier">logical_path</span>, <span class="ruby-identifier">pathname</span>, <span class="ruby-identifier">options</span>)
  <span class="ruby-identifier">pathname</span> = <span class="ruby-constant">Pathname</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">pathname</span>)

  <span class="ruby-comment"># If there are any processors to run on the pathname, use</span>
  <span class="ruby-comment"># `BundledAsset`. Otherwise use `StaticAsset` and treat is as binary.</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">attributes_for</span>(<span class="ruby-identifier">pathname</span>).<span class="ruby-identifier">processors</span>.<span class="ruby-identifier">any?</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">options</span>[<span class="ruby-value">:bundle</span>] <span class="ruby-operator">==</span> <span class="ruby-keyword">false</span>
      <span class="ruby-identifier">circular_call_protection</span>(<span class="ruby-identifier">pathname</span>.<span class="ruby-identifier">to_s</span>) <span class="ruby-keyword">do</span>
        <span class="ruby-constant">ProcessedAsset</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">index</span>, <span class="ruby-identifier">logical_path</span>, <span class="ruby-identifier">pathname</span>)
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">else</span>
      <span class="ruby-constant">BundledAsset</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">index</span>, <span class="ruby-identifier">logical_path</span>, <span class="ruby-identifier">pathname</span>)
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-constant">StaticAsset</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">index</span>, <span class="ruby-identifier">logical_path</span>, <span class="ruby-identifier">pathname</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- build_asset-source -->
            
          </div>

          

          
        </div><!-- build_asset-method -->

      
        <div id="cache_key_for-method" class="method-detail ">
          <a name="method-i-cache_key_for"></a>

          
          <div class="method-heading">
            <span class="method-name">cache_key_for</span><span
              class="method-args">(path, options)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            
            

            
            <div class="method-source-code" id="cache_key_for-source">
<pre>
<span class="ruby-comment"># File lib/sprockets/base.rb, line 251</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">cache_key_for</span>(<span class="ruby-identifier">path</span>, <span class="ruby-identifier">options</span>)
  <span class="ruby-node">&quot;#{path}:#{options[:bundle] ? '1' : '0'}&quot;</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- cache_key_for-source -->
            
          </div>

          

          
        </div><!-- cache_key_for-method -->

      
        <div id="circular_call_protection-method" class="method-detail ">
          <a name="method-i-circular_call_protection"></a>

          
          <div class="method-heading">
            <span class="method-name">circular_call_protection</span><span
              class="method-args">(path)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            
            

            
            <div class="method-source-code" id="circular_call_protection-source">
<pre>
<span class="ruby-comment"># File lib/sprockets/base.rb, line 255</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">circular_call_protection</span>(<span class="ruby-identifier">path</span>)
  <span class="ruby-identifier">reset</span> = <span class="ruby-constant">Thread</span>.<span class="ruby-identifier">current</span>[<span class="ruby-value">:sprockets_circular_calls</span>].<span class="ruby-identifier">nil?</span>
  <span class="ruby-identifier">calls</span> = <span class="ruby-constant">Thread</span>.<span class="ruby-identifier">current</span>[<span class="ruby-value">:sprockets_circular_calls</span>] <span class="ruby-operator">||=</span> <span class="ruby-constant">Set</span>.<span class="ruby-identifier">new</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">calls</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">path</span>)
    <span class="ruby-identifier">raise</span> <span class="ruby-constant">CircularDependencyError</span>, <span class="ruby-node">&quot;#{path} has already been required&quot;</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">calls</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">path</span>
  <span class="ruby-keyword">yield</span>
<span class="ruby-keyword">ensure</span>
  <span class="ruby-constant">Thread</span>.<span class="ruby-identifier">current</span>[<span class="ruby-value">:sprockets_circular_calls</span>] = <span class="ruby-keyword">nil</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">reset</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- circular_call_protection-source -->
            
          </div>

          

          
        </div><!-- circular_call_protection-method -->

      
        <div id="expire_index-21-method" class="method-detail ">
          <a name="method-i-expire_index-21"></a>

          
          <div class="method-heading">
            <span class="method-name">expire_index!</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Clear index after mutating state. Must be implemented by the subclass.</p>
            

            
            <div class="method-source-code" id="expire_index-21-source">
<pre>
<span class="ruby-comment"># File lib/sprockets/base.rb, line 229</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">expire_index!</span>
  <span class="ruby-identifier">raise</span> <span class="ruby-constant">NotImplementedError</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- expire_index-21-source -->
            
          </div>

          

          
        </div><!-- expire_index-21-method -->

      
      </div><!-- protected-instance-method-details -->
    
    </div><!-- 5Buntitled-5D -->
  

  </div><!-- documentation -->

  <div id="validator-badges">
    <p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
    <p><small>Generated with the <a href="http://deveiate.org/projects/Darkfish-Rdoc/">Darkfish
      Rdoc Generator</a> 2</small>.</p>
  </div>

</body>
</html>

